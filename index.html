<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safe Browsing Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            text-align: center;
        }
        #logTable {
            margin-top: 20px;
            width: 100%;
            border-collapse: collapse;
        }
        #logTable, th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>

    <h2>Click the link below:</h2>
    <a href="#" id="phishingLink">Claim Your Free Gift!</a>

    <h2>Logged Clicks:</h2>
    <table id="logTable">
        <thead>
            <tr>
                <th>IP Address</th>
                <th>User Agent</th>
                <th>Time</th>
            </tr>
        </thead>
        <tbody id="logData"></tbody>
    </table>

    <script>
        document.getElementById("phishingLink").addEventListener("click", function(event) {
            event.preventDefault();
            
            fetch("http://localhost:5000/log", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    userAgent: navigator.userAgent
                })
            }).then(response => response.json())
            .then(data => updateLogs(data.data));

            alert("This was a phishing attempt! Always check links before clicking.");
        });

        function updateLogs(logs) {
            let logTable = document.getElementById("logData");
            logTable.innerHTML = "";
            logs.forEach(log => {
                let row = `<tr>
                    <td>${log["IP Address"]}</td>
                    <td>${log["User Agent"]}</td>
                    <td>${log["Time"]}</td>
                </tr>`;
                logTable.innerHTML += row;
            });
        }

        // Load logs on page load
        function loadLogs() {
            fetch("http://localhost:5000/logs")
            .then(response => response.json())
            .then(data => updateLogs(data));
        }
        loadLogs();
    </script>

</body>
</html>
